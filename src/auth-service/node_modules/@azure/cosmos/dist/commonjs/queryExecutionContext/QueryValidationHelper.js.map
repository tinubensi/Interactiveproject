{"version":3,"file":"QueryValidationHelper.js","sourceRoot":"","sources":["../../../src/queryExecutionContext/QueryValidationHelper.ts"],"names":[],"mappings":";;;AAqBA,oGAcC;AAnCD,uCAAuC;AACvC,kCAAkC;AAClC,kEAA4D;AAY5D;;;;;;GAMG;AACH,SAAgB,4CAA4C,CAC1D,iBAAqC,EACrC,qBAA6C;IAE7C,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACvB,OAAO;IACT,CAAC;IAED,wDAAwD;IACxD,MAAM,oBAAoB,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;IAE5F,IAAI,oBAAoB,EAAE,CAAC;QACzB,MAAM,IAAI,gCAAa,CAAC,oBAAoB,CAAC,YAAY,CAAC,CAAC;IAC7D,CAAC;AACH,CAAC;AAED;;;GAGG;AACU,QAAA,UAAU,GAAG;IACxB,mBAAmB,EAAE,CAAC,SAAkB,EAAwB,EAAE,CAAC,CAAC;QAClE,IAAI,EAAE,qBAAqB;QAC3B,SAAS;QACT,YAAY,EACV,4EAA4E;YAC5E,sHAAsH;YACtH,6FAA6F;KAChG,CAAC;IAEF,OAAO,EAAE,CAAC,SAAkB,EAAwB,EAAE,CAAC,CAAC;QACtD,IAAI,EAAE,SAAS;QACf,SAAS;QACT,YAAY,EACV,8DAA8D;YAC9D,mHAAmH;YACnH,6FAA6F;KAChG,CAAC;IAEF,iBAAiB,EAAE,CAAC,SAAkB,EAAwB,EAAE,CAAC,CAAC;QAChE,IAAI,EAAE,mBAAmB;QACzB,SAAS;QACT,YAAY,EACV,wEAAwE;YACxE,gHAAgH;YAChH,6HAA6H;KAChI,CAAC;IAEF,YAAY,EAAE,CAAC,SAAkB,EAAwB,EAAE,CAAC,CAAC;QAC3D,IAAI,EAAE,cAAc;QACpB,SAAS;QACT,YAAY,EACV,mEAAmE;YACnE,sFAAsF;YACtF,4GAA4G;YAC5G,6FAA6F;KAChG,CAAC;IAEF,+CAA+C;IAC/C,YAAY,EAAE,CAAC,SAAkB,EAAwB,EAAE,CAAC,CAAC;QAC3D,IAAI,EAAE,cAAc;QACpB,SAAS;QACT,YAAY,EACV,mEAAmE;YACnE,mFAAmF;YACnF,oDAAoD;YACpD,6FAA6F;KAChG,CAAC;CACM,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT License.\nimport { ErrorResponse } from \"../request/ErrorResponse.js\";\n\n/**\n * Represents a query type that doesn't support continuation tokens\n * @internal\n */\nexport interface UnsupportedQueryType {\n  readonly name: string;\n  readonly isPresent: boolean;\n  readonly errorMessage: string;\n}\n\n/**\n * Rejects continuation token usage for unsupported query types\n * @param continuationToken - The continuation token if provided\n * @param unsupportedQueryTypes - Array of query types that don't support continuation tokens\n * @throws ErrorResponse if continuation token is provided for any unsupported query type\n * @hidden\n */\nexport function rejectContinuationTokenForUnsupportedQueries(\n  continuationToken: string | undefined,\n  unsupportedQueryTypes: UnsupportedQueryType[],\n): void {\n  if (!continuationToken) {\n    return;\n  }\n\n  // Find the first unsupported query type that is present\n  const conflictingQueryType = unsupportedQueryTypes.find((queryType) => queryType.isPresent);\n\n  if (conflictingQueryType) {\n    throw new ErrorResponse(conflictingQueryType.errorMessage);\n  }\n}\n\n/**\n * Factory functions for creating unsupported query type descriptors\n * @internal\n */\nexport const QueryTypes = {\n  nonStreamingOrderBy: (isPresent: boolean): UnsupportedQueryType => ({\n    name: \"NonStreamingOrderBy\",\n    isPresent,\n    errorMessage:\n      \"Continuation tokens are not supported for non-streaming ORDER BY queries. \" +\n      \"These queries must process all results to ensure correct ordering and cannot be resumed from an intermediate state. \" +\n      \"Consider removing the continuation token and using fetchAll() instead for complete results.\",\n  }),\n\n  groupBy: (isPresent: boolean): UnsupportedQueryType => ({\n    name: \"GroupBy\",\n    isPresent,\n    errorMessage:\n      \"Continuation tokens are not supported for GROUP BY queries. \" +\n      \"These queries must process all results to compute aggregations and cannot be resumed from an intermediate state. \" +\n      \"Consider removing the continuation token and using fetchAll() instead for complete results.\",\n  }),\n\n  unorderedDistinct: (isPresent: boolean): UnsupportedQueryType => ({\n    name: \"UnorderedDistinct\",\n    isPresent,\n    errorMessage:\n      \"Continuation tokens are not supported for unordered DISTINCT queries. \" +\n      \"These queries require tracking large amounts of duplicate data in continuation tokens which is not practical. \" +\n      \"Consider removing the continuation token and using fetchAll() instead, or use ordered DISTINCT queries which are supported.\",\n  }),\n\n  hybridSearch: (isPresent: boolean): UnsupportedQueryType => ({\n    name: \"HybridSearch\",\n    isPresent,\n    errorMessage:\n      \"Continuation tokens are not supported for hybrid search queries. \" +\n      \"Hybrid search queries require processing and ranking of all component query results \" +\n      \"to compute accurate Reciprocal Rank Fusion (RRF) scores and cannot be resumed from an intermediate state. \" +\n      \"Consider removing the continuation token and using fetchAll() instead for complete results.\",\n  }),\n\n  // Easy to add new unsupported query types here\n  vectorSearch: (isPresent: boolean): UnsupportedQueryType => ({\n    name: \"VectorSearch\",\n    isPresent,\n    errorMessage:\n      \"Continuation tokens are not supported for vector search queries. \" +\n      \"Vector search queries require processing similarity calculations across all data \" +\n      \"and cannot be resumed from an intermediate state. \" +\n      \"Consider removing the continuation token and using fetchAll() instead for complete results.\",\n  }),\n} as const;\n"]}